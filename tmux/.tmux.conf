# make colors work nice
set -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"

# don't add a delay when pressing escape
set -s escape-time 0

# if-shell -b "[ $CURRENT_THEME = 'tokyonight' ]" {
    # tokyonight theme
    thm_fg="#c0caf5"
    thm_bg="#1a1b26"
    thm_gray="#3b4261"
    thm_cyan="#73daca"
    thm_blue="#7aa2f7"
    thm_purple="#9d7cd8"
    thm_active="#73daca"
# }
# if-shell -b "[ $CURRENT_THEME = 'gruvbox' ]" {
    # gruvbox material theme
    # thm_fg="#d4be98"
    # thm_bg="#1d2021"
    # thm_gray="#504945"
    # thm_cyan="#89b482"
    # thm_blue="#7daea3"
    # thm_purple="#d3869b"
    # thm_active="#e78a4e"
# }
# if-shell -b "[ $CURRENT_THEME = 'electronhighlighter' ]" {
    # electron_highlighter theme
#     thm_fg="#a8b5d1"
#     thm_bg="#212836"
#     thm_gray="#3b4261"
#     thm_cyan="#4ff2f8"
#     thm_blue="#82aaff"
#     thm_purple="#a78bfa"
#     thm_active="#34febb"
# }

# status
set -gq status "on"
set -gq status-bg "${thm_bg}"
set -gq status-justify "left"
set -gq status-left-length "100"
set -gq status-right-length "100"

# messages
set -gq message-style "fg=${thm_cyan},bg=${thm_gray},align=centre"
set -gq message-command-style "fg=${thm_cyan},bg=${thm_gray},align=centre"

# panes
set -gq pane-border-style "fg=${thm_gray}"
set -gq pane-active-border-style "fg=${thm_blue}"

# windows
setw -gq window-status-activity-style "fg=${thm_fg},bg=${thm_bg},none"
setw -gq window-status-separator ""
setw -gq window-status-style "fg=${thm_fg},bg=${thm_bg},none"

# --------=== Statusline

wt_enabled="off"
right_separator="█"
left_separator="█"

# current directory name
right_column1="#[fg=$thm_purple,bg=$thm_bg,nobold,nounderscore,noitalics]$right_separator#[fg=$thm_bg,bg=$thm_purple,nobold,nounderscore,noitalics]  #[fg=$thm_fg,bg=$thm_gray] #{b:pane_current_path} "

# current session name
right_column2="#[fg=$thm_cyan,bg=$thm_gray]$right_separator#[fg=$thm_bg,bg=$thm_cyan,nobold,nounderscore,noitalics] #[fg=$thm_fg,bg=$thm_gray] #S "

# inactive window
window_status_format="#[fg=$thm_blue,bg=$thm_gray] #I #[fg=$thm_fg,bg=$thm_bg] #W "

# active window
window_status_current_format="#[fg=$thm_bg,bg=$thm_active] #I #[fg=$thm_fg,bg=$thm_bg] #W "

set -gq status-left ""

set -gq status-right "${right_column1}${right_column2}"

setw -gq window-status-format "${window_status_format}"
setw -gq window-status-current-format "${window_status_current_format}"

#------------------------------
# End theme
#------------------------------

# Undercurl
set -g default-terminal "${TERM}"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0

# ctrl-b r to reload tmux.conf
bind r source-file ~/.tmux.conf

# windows start at index 1 instead of 0
set -g base-index 1

# allow mouse to scroll instead of sending up/down arrow key events
set -g mouse on

# vim keybindings
set-window-option -g mode-keys vi

# vim bindings in copy-mode.
# this lets me use v to select text and y to yank text to clipboard
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind P paste-buffer
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# the following options are from tmux-sensible:
# Increase scrollback buffer size from 2000 to 50000 lines
set -g history-limit 50000

# Increase tmux messages display duration from 750ms to 4s
set -g display-time 4000

# Refresh 'status-left' and 'status-right' more often, from every 15s to 5s
set -g status-interval 5

# Emacs key bindings in tmux command prompt (prefix + :) are better than
# vi keys, even for vim users
set -g status-keys emacs

# Focus events enabled for terminals that support them
set -g focus-events on

# Super useful when using "grouped sessions" and multi-monitor setup
setw -g aggressive-resize on
# end tmux-sensible options

# vim-like pane switching
bind -r ^ last-window
bind -r k select-pane -U
bind -r j select-pane -D
bind -r h select-pane -L
bind -r l select-pane -R

# don't confirm before deleting windows and panes.
bind-key & kill-window
bind-key x kill-pane

# forget the find window.  That is for chumps
bind-key -r f run-shell "tmux neww ~/.local/bin/tmux-sessionizer"
bind-key -r k run-shell "~/.local/bin/tmux-sessionizer"

# use zsh in tmux
# set -g default-command /opt/homebrew/bin/zsh
# set -g default-shell /opt/homebrew/bin/zsh

# use fish in tmux
set -g default-command /opt/homebrew/bin/fish
set -g default-shell /opt/homebrew/bin/fish

# plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'nhdaly/tmux-better-mouse-mode'
set -g @plugin 'fcsonline/tmux-thumbs'

# plugin configs
set -g @continuum-boot 'on' # have continuum boot up when computer restarts.
set -g @continuum-restore 'on' # tell continuum to restore previous session.
set -g @continuum-boot-options 'kitty' # tell tmux-continuum to start when computer starts. Tell it to use kitty.

run-shell ~/.tmux/plugins/tmux-thumbs/tmux-thumbs.tmux


# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
